<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>PGEA06 - Estatística Aplicada</title>
    <meta charset="utf-8" />
    <meta name="author" content="Elizabeth Mie Hashimoto   DAMAT-LD" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/metropolis.css" rel="stylesheet" />
    <link href="libs/remark-css/metropolis-fonts.css" rel="stylesheet" />
    <script src="libs/kePrint/kePrint.js"></script>
    <link href="libs/lightable/lightable.css" rel="stylesheet" />
    <script src="libs/htmlwidgets/htmlwidgets.js"></script>
    <script src="libs/plotly-binding/plotly.js"></script>
    <script src="libs/typedarray/typedarray.min.js"></script>
    <script src="libs/jquery/jquery.min.js"></script>
    <link href="libs/crosstalk/css/crosstalk.min.css" rel="stylesheet" />
    <script src="libs/crosstalk/js/crosstalk.min.js"></script>
    <link href="libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="libs/plotly-main/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="tema_pgea06.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# PGEA06 - Estatística Aplicada
]
.subtitle[
## modelo de regressão linear e <br>modelo de classificação
]
.author[
### Elizabeth Mie Hashimoto <br> DAMAT-LD
]

---



&lt;style&gt; 
#caixa {
  border: 1px solid;
  padding: 10px;
  box-shadow: 5px 10px blue;
}
div {
  text-align: justify;
  text-justify: inter-word;
}
&lt;/style&gt;

&lt;style type="text/css"&gt;
.remark-slide-content {
    font-size: 30px;
}
&lt;/style&gt;

# Modelo de regressão

&lt;img src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExNmlqY3J1bTc0Nnc3ZmRsdWQxNTdoejluMWp1b2Y0dXIwYnUwM2UxYyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/RCtKcMeeIlIFskmH7C/giphy.gif" width="70%" style="display: block; margin: auto;" /&gt;

--

- **Variáveis** associada à um fenômeno

--

- Fazer uma **representação matemática**

&lt;center&gt;&lt;small&gt;variável resposta = variáveis explicativas + termo aleatório &lt;/small&gt;&lt;/center&gt;

---

# Modelo de regressão

&amp;#127919; Estudar a **associação** entre duas ou mais variáveis.


&lt;img src="pgea06_aula05_files/figure-html/unnamed-chunk-2-1.png" width="50%" style="display: block; margin: auto;" /&gt;

--

- Relação **linear** entre as variáveis.

---

# Correlação de Pearson

- Quantificar o grau de relação entre duas variáveis quantitativas.

&lt;table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:center;"&gt; Valores &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Interpretação &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 0,00 a 0,19 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Correlação bem fraca &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 0,20 a 0,39 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Correlação fraca &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 0,40 a 0,69 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Correlação moderada &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 0,70 a 0,89 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Correlação forte &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 0,90 a 1,00 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Correlação muito forte &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;tfoot&gt;
&lt;tr&gt;&lt;td style="padding: 0; " colspan="100%"&gt;&lt;span style="font-style: italic;"&gt;Note: &lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td style="padding: 0; " colspan="100%"&gt;
&lt;sup&gt;&lt;/sup&gt; http://leg.ufpr.br/~silvia/CE003/node74.html &lt;/td&gt;&lt;/tr&gt;
&lt;/tfoot&gt;
&lt;/table&gt;

---

# Cuidado com a Interpretação

&lt;img src="https://i.giphy.com/media/v1.Y2lkPTc5MGI3NjExZTYzajA1dzk2bzdmMW55eXZtNXRpbHlzYzl4M2EwcDZpbmJncTE5OCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/3ov9k9Ss9N3wO6FQ7C/giphy.gif" width="25%" style="display: block; margin: auto auto auto 0;" /&gt;

.pull-left[
"A venda de sorte é fortemente correlacionada com o número de afogamentos."
]
.pull-right[
&lt;img src="figuras/espuria.jpg" width="90%" style="display: block; margin: auto;" /&gt;
]

---

# Explicação

&lt;img src="figuras/cor_vs_casual.png" width="100%" style="display: block; margin: auto;" /&gt;
&lt;center&gt;&lt;small&gt;https://estatisticafacil.org/correlacao-vs-causalidade/&lt;/small&gt;&lt;/center&gt;

---

# Modelo de regressão linear simples

- **Uma** variável explicativa 

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="pgea06_aula05_files/figure-html/unnamed-chunk-7-1.png" alt="Gráfico de dispersão" width="50%" /&gt;
&lt;p class="caption"&gt;Gráfico de dispersão&lt;/p&gt;
&lt;/div&gt;

---

# Modelo de regressão linear múltipa

- **Duas** variáveis explicativas  

<div class="plotly html-widget html-fill-item" id="htmlwidget-59ccfb3fed0f97c71112" style="width:100%;height:400px;"></div>
<script type="application/json" data-for="htmlwidget-59ccfb3fed0f97c71112">{"x":{"visdat":{"15902d6f3f4d":["function () ","plotlyVisDat"]},"cur_data":"15902d6f3f4d","attrs":{"15902d6f3f4d":{"x":{},"y":{},"z":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"Valores de x1"},"yaxis":{"title":"Valores de y"},"zaxis":{"title":"Valores de x2"}},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[2.6200000000000001,2.875,2.3199999999999998,3.2149999999999999,3.4399999999999999,3.46,3.5699999999999998,3.1899999999999999,3.1499999999999999,3.4399999999999999,3.4399999999999999,4.0700000000000003,3.73,3.7799999999999998,5.25,5.4240000000000004,5.3449999999999998,2.2000000000000002,1.615,1.835,2.4649999999999999,3.52,3.4350000000000001,3.8399999999999999,3.8450000000000002,1.9350000000000001,2.1400000000000001,1.5129999999999999,3.1699999999999999,2.77,3.5699999999999998,2.7799999999999998],"y":[21,21,22.800000000000001,21.399999999999999,18.699999999999999,18.100000000000001,14.300000000000001,24.399999999999999,22.800000000000001,19.199999999999999,17.800000000000001,16.399999999999999,17.300000000000001,15.199999999999999,10.4,10.4,14.699999999999999,32.399999999999999,30.399999999999999,33.899999999999999,21.5,15.5,15.199999999999999,13.300000000000001,19.199999999999999,27.300000000000001,26,30.399999999999999,15.800000000000001,19.699999999999999,15,21.399999999999999],"z":[160,160,108,258,360,225,360,146.69999999999999,140.80000000000001,167.59999999999999,167.59999999999999,275.80000000000001,275.80000000000001,275.80000000000001,472,460,440,78.700000000000003,75.700000000000003,71.099999999999994,120.09999999999999,318,304,350,400,79,120.3,95.099999999999994,351,145,301,121],"type":"scatter3d","mode":"markers","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>

---

# Adequação do modelo

&lt;center&gt;variável resposta = variáveis explicativas + termo aleatório &lt;/center&gt;

--

Usando **notação matemática**:

`$$y=\beta_0+\beta_1x_1+\ldots\beta_px_p+\varepsilon$$`
em que o erro aleatório satisfaz as seguintes características:

--

- segue distribuição normal com média zero e variância `\(\sigma^2\)`.

--

- a variância deve ser constante.

--

- os erros devem ser independentes.

---

# Roteiro da análise de regressão

- Fazer um gráfico de dispersão;

--

- Determinar a correlação entre as variáveis;

--

- Estimar o modelo de regressão linear

--

- Análise de resíduo:
  - Teste de normalidade
  
  - Teste de homogeneidade de variâncias
  
  As hipóteses a serem testadas são
  
  `\(H_0\)`: as variâncias são homogêneas vs   `\(H_1\)`: as variâncias são heterogêneas
  
---
- Análise de resíduo:

  - Teste de Durbin-Watson
  
  As hipóteses são
  
  `\(H_0\)`: os erros são independentes vs   `\(H_1\)`: os erros são dependentes

---

# Exemplo

Na engenharia de recursos hídricos, a estimativa dos tamanhos dos reservatórios depende de estimativas acuradas do escoamento da água no rio que está sendo confinado. Em alguns rios, registros históricos de longa duração de tais dados de escoamento são difíceis de obter. Já os dados meteorológicos sobre precipitação estão disponíveis para muitos anos do passado. Portanto, é útil determinar a relação entre escoamento e precipitação.

---

Essa relação pode ser usada para fazer uma estimativa do escoamento nos anos nos quais apenas medidas de precipitação foram feitas. Os seguintes dados estão disponíveis para um rio que deve ser estancado:

- Precipitação:

```
[1] 117.4 123.2  94.3  91.7 111.5 112.0  94.1 110.8
```

- Escoamento:

```
[1] 19.6 18.5 17.1 12.9 18.4 18.1 15.5 18.1
```

---

# Modelo de classificação

Em Engenharia Ambiental, muitas vezes precisamos classificar dados em categorias, como:

--

.pull-left[

- Contaminado

&lt;img src="https://i.giphy.com/media/v1.Y2lkPTc5MGI3NjExcHg4djB4Z3R4a2g3cm02MDVpeWUxaXVzOHpwbTE4djM1OWYxYzNpOSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/OLEFkLMQJ5v1btVbRn/giphy.gif" width="50%" style="display: block; margin: auto;" /&gt;
]
.pull-right[

- Não contaminado

&lt;img src="https://i.giphy.com/media/v1.Y2lkPTc5MGI3NjExNnF5eWl4ZGhmYnQ2cnRsdnJ1OHhlN3ZhMDN4aWoydnJmdzd3b2huMiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/l1KVcrdl7rJpFnY2s/giphy.gif" width="65%" style="display: block; margin: auto;" /&gt;
]

--

&lt;center&gt;Modelo de regressão logística&lt;/center&gt;

---

- Fazer uma previsão

&lt;img src="figuras/classificar.png" width="85%" style="display: block; margin: auto;" /&gt;

---

# Modelo de regressão logística

- Utiliza para modelar a **probabilidade de um evento**.

A função logística é dada por

`$$P(Y=1|\mathbf{X})=\frac{1}{1+e^{-(\beta_0+\beta_1x_1+\ldots,\beta_px_p)}}$$`

--

O resultado do modelo é uma probabilidade entre 0 e 1. 

--

&lt;!-- Por exemplo, se o modelo retorna 0.7, isso significa que há 70% de chance de a área estar contaminada. --&gt;

- **Decisão de Classificação**: definir um limite (*threshold*). Comumente, utilizamos 0,5.
&lt;!-- e a probabilidade for maior que 0.5, classificamos como "contaminado"; caso contrário, "não contaminado". --&gt;

---

# Ajuste do modelo

- **Treinamento**: Utilizamos um conjunto de dados rotulados (com áreas conhecidas como contaminadas ou não) para treinar o modelo, ajustando os coeficientes betas.

--

- **Validação**: Avaliamos o modelo com um conjunto de testes e utilizamos métricas como precisão, sensibilidade e especificidade para medir o desempenho.

---

# Exemplo 

    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": false,
"countIncrementalSlides": false,
"slideNumberFormat": "%current%"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
