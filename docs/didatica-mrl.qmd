---
title: |
  | Regress√£o
  | Linear Simples
title-slide-attributes:
    data-background-image: imagem/fundo_clima1.png
    data-background-size: 100%
    #data-background-opacity: "0.75"
author: "Elizabeth Mie Hashimoto"
institute: "emiehashimoto@gmail.com"
format:
  revealjs:
    #incremental: true
    #footer: "Modelos de Regress√£o"
    slide-number: false
    multiplex: false
    theme: [solarized, tema.scss]
    show-slide-number: print
    controls: true
    width: 1280
    height: 720
    css: [custom.css]
    menu: false
    chalkboard: true
execute:
  echo: true
from: markdown+emoji
---

## Objetivo da Aula

::: {.callout-tip appearance="simple"}
- Apresentar os conceitos de regress√£o linear simples.

- Demonstrar a obten√ß√£o dos estimadores
dos par√¢metros por meio do m√©todo de m√≠nimos quadrados.
:::

## Motiva√ß√£o

<br>

```{r , echo=FALSE, fig.align = 'center', out.width = '100%'}
knitr::include_graphics('figuras/noticia.png')
```

---

- **M√™s passado**

&#128240; Tornado que atingiu o munic√≠pio de Rio Bonito do Igua√ßu (PR)

```{r , echo=FALSE, fig.align = 'center', out.width = '100%'}
knitr::include_graphics('figuras/rio_bonito.png')
```


Fonte: https://g1.globo.com/sp/campinas-regiao

---

```{r , echo=FALSE, fig.align = 'center', out.width = '100%'}
knitr::include_graphics('figuras/variaveis.png')
```

<br>

::: {.incremental}
- Fen√¥menos aleat√≥rio $\longrightarrow$ express√£o matem√°tica
:::

---

::: {.meubox}
<div class="meubox-title">An√°lise de regress√£o</div>
<div class="meubox-content">
Conjunto de t√©cnicas estat√≠sticas aplicadas na investiga√ß√£o e modelagem da rela√ß√£o entre vari√°veis.
</div>
:::

<br>

. . .

Os dois principais objetivos da an√°lise s√£o:

::: {.incremental}
- avaliar o efeito (ou rela√ß√£o) entre as vari√°veis;

- predizer valores n√£o observados.
:::

# Defini√ß√£o

## Ajustar um modelo

... *descrever* a rela√ß√£o entre as vari√°veis $X$ e $Y$ 

```{r}
#| echo: false
#| out.width: "70%"
#| fig.show: 'hide'
#| 
library(ggplot2)
library(fivethirtyeight)

movie_scores <- fandango |> 
  dplyr::rename(
    critics = rottentomatoes, 
    audience = rottentomatoes_user
  )

p <- movie_scores |> 
  ggplot() +
  aes(x = critics, y = audience) +
  geom_point(alpha = 0.5) + 
  geom_smooth(method = "lm", color = "purple", se = FALSE) +
  labs(
    x = "Vari√°vel x" , 
    y = "Vari√°vel y"
    ) +
  theme(
    axis.title = element_text(size=20),
    axis.text = element_text(size=20)
  )

p
```

::: {.panel-tabset}
## Figura

```{r}
#| echo: false
#| out.width: "70%"
#| fig-align: "center"
p
```

## R

``` {.r}
movie_scores |> 
  ggplot() +
  aes(x = critics, y = audience) +
  geom_point(alpha = 0.5) + 
  geom_smooth(method = "lm", color = "purple", se = FALSE) +
  labs(
    x = "Vari√°vel x" , 
    y = "Vari√°vel y"
    )
```

:::

## Nota√ß√£o

::: columns
::: {.column width="40%"}
-   **Y**: vari√°vel resposta

-   **x**: vari√°vel explicativa 
:::

::: {.column width="60%"}
```{r}
#| out.width: "100%"
#| echo: false
p
```
:::
:::

## Modelo de regress√£o {#regression-model-1}

<br>

Um **modelo de regress√£o** √© uma fun√ß√£o que descreve a rela√ß√£o entre a vari√°vel resposta $Y$ e a vari√°vel explicativa $x$.

$$\begin{aligned} Y &= \color{black}{\textbf{Modelo}} + \text{Erro aleat√≥rio} \\[8pt]
&= \color{black}{\mathbf{f(x)}} + \epsilon \\[8pt]
&= \color{black}{\boldsymbol{\mu_{Y|x}}} + \epsilon \end{aligned}$$

## Modelo de regress√£o

::: columns
::: {.column width="30%"}
$$
\begin{aligned} Y &= \color{purple}{\textbf{Model}} + \text{Erro aleat√≥rio} \\[8pt]
&= \color{purple}{\mathbf{f(x)}} + \epsilon \\[8pt]
&= \color{purple}{\boldsymbol{\mu_{Y|x}}} + \epsilon 
\end{aligned}
$$
:::

::: {.column width="70%"}
```{r}
#| echo: false
m <- lm(audience ~ critics, data = movie_scores)

ggplot(data = movie_scores, 
       mapping = aes(x = critics, y = audience)) +
  geom_point(alpha = 0.5) + 
  geom_smooth(method = "lm", color = "purple", se = FALSE) +
  labs(x = "X", y = "Y") +
  theme_minimal() +
  theme(
    axis.text = element_blank(),
    axis.ticks.x = element_blank(), 
    axis.ticks.y = element_blank()
    )
```
:::
:::

## Modelo de regress√£o

<br>

::: columns
::: {.column width="40%"}
$$\begin{aligned} Y &= \color{purple}{\textbf{Model}} + \color{blue}{\textbf{Erro aleat√≥rio}} \\[8pt]
&= \color{purple}{\mathbf{f(x)}} + \color{blue}{\boldsymbol{\epsilon}} \\[8pt]
&= \color{purple}{\boldsymbol{\mu_{Y|x}}} + \color{blue}{\boldsymbol{\epsilon}} \\[8pt]
 \end{aligned}$$
:::

::: {.column width="60%"}
```{r}
#| echo: false
ggplot(data = movie_scores,
       mapping = aes(x = critics, y = audience)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", color = "purple", se = FALSE) +
  geom_segment(aes(x = critics, xend = critics, 
                   y = audience, yend = predict(m)), 
               color = "blue") +
  labs(x = "X", y = "Y") +
  theme(
    axis.text = element_blank(),
    axis.ticks.x = element_blank(),
    axis.ticks.y = element_blank()
  )
```
:::
:::

## Modelo de regress√£o linear simples

O modelo de regress√£o linear **simples** descreve a rela√ß√£o entre uma vari√°vel resposta ($Y$) e uma √∫nica vari√°vel explicativa ($x$), assumindo uma rela√ß√£o aproximadamente linear entre elas. Nesse caso, o modelo √© dado por:

$$\Large{Y = \beta_0 + \beta_1 x + \epsilon}$$

::: incremental
-   $\beta_1$: inclina√ß√£o da reta entre $x$ e $Y$
-   $\beta_0$: intercepto
-   $\epsilon$: erro aleat√≥rio
:::

## Modelo estimado

$$\Large{\hat{Y} = \hat{\beta}_0 + \hat{\beta}_1 x}$$

-   $\hat{\beta}_0$ e $\hat{\beta}_1$: par√¢metros dos coeficientes da regress√£o.
-   N√£o h√° o termo aleat√≥rio!

## Estima√ß√£o de par√¢metros

```{r}
#| echo: false
ggplot(data = movie_scores, 
       mapping = aes(x = critics, y = audience)) +
  geom_point(alpha = 0.4) + 
  geom_abline(intercept = 32.3155, slope = 0.5187, color = "purple", size = 1) +
  geom_abline(intercept = 25, slope = 0.7, color = "gray") +
  geom_abline(intercept = 21, slope = 0.9, color = "gray") +
  geom_abline(intercept = 35, slope = 0.3, color = "gray") +
  labs(
    x = "Vari√°vel x" , 
    y = "Vari√°vel y"
    ) +
  theme(
    axis.title = element_text(size=20),
    axis.text = element_text(size=20)
  )
```

---

::: {.meubox-lilas}
***Res√≠duo** *
:::

<br>

```{r}
#| warning: false
#| message: false
#| echo: false
#| fig-align: 'center'

ggplot(data = movie_scores, mapping = aes(x = critics, y = audience)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", color = "purple", se = FALSE) +
  geom_segment(aes(x = critics, xend = critics, y = audience, yend = predict(m)), color = "steel blue") +
  labs(
    x = "Vari√°vel x" , 
    y = "Vari√°vel y"
    ) +
  theme(
    axis.title = element_text(size=20),
    axis.text = element_text(size=20)
  ) +
  theme(legend.position = "none")
```

$$\text{res√≠duo} = \text{valor observado} - \text{valor predito} = y - \hat{y}$$
---

::: {.meubox-lilas}
***M√©todo de m√≠nimos quadrados** *
:::


- O res√≠duo da $i$-√©sima observa√ß√£o √© dado por

$$e_i = \text{valor observado} - \text{varlo predito} = y_i - \hat{y}_i$$

-   A **soma de quadrados** dos res√≠duos √© dada por

$$e^2_1 + e^2_2 + \dots + e^2_n$$

-   O m√©todo de m√≠nimos quadrados baseia-se na determina√ß√£o de $\beta_0$ e $\beta_1$
tal que a soma de quadrados dos res√≠duos seja m√≠nima.

---

$$\frac{\partial S}{\partial\beta_0}=-2\sum_{i=1}^{n}(y_i-\hat{\beta}_0-\hat{\beta}_1x_i)=0$$

<br>

$$\frac{\partial S}{\partial\beta_1}=-2\sum_{i=1}^{n}(y_i-\hat{\beta}_0-\hat{\beta}_1x_i)x_i=0$$

```{r}
#| echo: false
sx <- round(sqrt(var(movie_scores$critics)), 4)
sy <- round(sqrt(var(movie_scores$audience)), 4)
r <- round(cor(movie_scores$critics, movie_scores$audience), 4)
xbar <- round(mean(movie_scores$critics), 4)
ybar <- round(mean(movie_scores$audience), 4)
```

## Exerc√≠cio üå™Ô∏è

Recentemente, um tornado com ventos de at√© 250 km/h atingiu a regi√£o de Rio Bonito. Suponha que pesquisadores registraram a velocidade do vento em diferentes pontos da cidade e estimaram o percentual de resid√™ncias danificadas em cada local. Os dados simulados s√£o apresentados na Tabela 1.

---

**Tabela 1** - Velocidade do vento e percentual de resid√™ncias danificadas em diferentes pontos da cidade de Rio Bonito.

| Local | Velocidade do vento (km/h) | Danos em resid√™ncias (%) |
| :---- | :------------------------: | :----------------------: |
| A     |             180            |            10            |
| B     |             200            |            25            |
| C     |             220            |            40            |
| D     |             230            |            50            |
| E     |             240            |            70            |
| F     |             250            |            85            |

Estimar o modelo de regress√£o linear simples.

## Utilizando o software R

<br>

::: columns
::: {.column width="50%"}
```{r}
#| output: false
#| code-line-numbers: "|1-4|6-14"

#data-frame
velocidade <- c(180,200,220,230,240,250)
danos <- c(10,25,40,50,70,85)
df_vento <- data.frame(velocidade, danos)

#diagrama de dispers√£o
df_vento |> 
  ggplot() +
  aes(x = velocidade, y = danos) +
  geom_point(size = 8) +
  labs(x = 'Velocidade do vento (km/h)', 
       y = 'Danos em resid√™ncias (%)') +
  theme(axis.title = element_text(size=30),
        axis.text = element_text(size=30))
```
:::

::: {.column width="50%"}
```{r}
#| echo: false

#data-frame
velocidade <- c(180,200,220,230,240,250)
danos <- c(10,25,40,50,70,85)
df_vento <- data.frame(velocidade, danos)

#diagrama de dispers√£o
df_vento |> 
  ggplot() +
  aes(x = velocidade, y = danos) +
  geom_point(size = 8) +
  labs(x = 'Velocidade do vento (km/h)', 
       y = 'Danos em resid√™ncias (%)') +
  theme(axis.title = element_text(size=30),
        axis.text = element_text(size=30))
```
:::
:::

---

```{r}
#| echo: true

fit <- lm(danos~velocidade, data=df_vento)
fit
```

## Bibliografia

<br>

:::: {.columns}

::: {.column width="50%"}
```{r,echo=FALSE, fig.align='center', out.width='65%'}
knitr::include_graphics('figuras/reg1.jpg')
```
:::

::: {.column width="50%"}
```{r,echo=FALSE, fig.align='center', out.width='58%'}
knitr::include_graphics('figuras/reg2.jpg')
```
:::

::::

## Atividade pr√°tica

<br>

- Abram a plataforma


```{r,echo=FALSE, fig.align='center', out.width='48%'}
knitr::include_graphics('figuras/moodle.png')
```
